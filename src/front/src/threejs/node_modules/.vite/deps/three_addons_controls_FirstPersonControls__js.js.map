{
  "version": 3,
  "sources": ["../../three/examples/jsm/controls/FirstPersonControls.js"],
  "sourcesContent": ["import {\n\tMathUtils,\n\tSpherical,\n\tVector3\n} from 'three';\n\nconst _lookDirection = new Vector3();\nconst _spherical = new Spherical();\nconst _target = new Vector3();\n\nclass FirstPersonControls {\n\n\tconstructor( object, domElement ) {\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\n\t\tthis.movementSpeed = 1.0;\n\t\tthis.lookSpeed = 0.005;\n\n\t\tthis.lookVertical = true;\n\t\tthis.autoForward = false;\n\n\t\tthis.activeLook = true;\n\n\t\tthis.heightSpeed = false;\n\t\tthis.heightCoef = 1.0;\n\t\tthis.heightMin = 0.0;\n\t\tthis.heightMax = 1.0;\n\n\t\tthis.constrainVertical = false;\n\t\tthis.verticalMin = 0;\n\t\tthis.verticalMax = Math.PI;\n\n\t\tthis.mouseDragOn = false;\n\n\t\t// internals\n\n\t\tthis.autoSpeedFactor = 0.0;\n\n\t\tthis.pointerX = 0;\n\t\tthis.pointerY = 0;\n\n\t\tthis.moveForward = false;\n\t\tthis.moveBackward = false;\n\t\tthis.moveLeft = false;\n\t\tthis.moveRight = false;\n\n\t\tthis.viewHalfX = 0;\n\t\tthis.viewHalfY = 0;\n\n\t\t// private variables\n\n\t\tlet lat = 0;\n\t\tlet lon = 0;\n\n\t\t//\n\n\t\tthis.handleResize = function () {\n\n\t\t\tif ( this.domElement === document ) {\n\n\t\t\t\tthis.viewHalfX = window.innerWidth / 2;\n\t\t\t\tthis.viewHalfY = window.innerHeight / 2;\n\n\t\t\t} else {\n\n\t\t\t\tthis.viewHalfX = this.domElement.offsetWidth / 2;\n\t\t\t\tthis.viewHalfY = this.domElement.offsetHeight / 2;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onPointerDown = function ( event ) {\n\n\t\t\tif ( this.domElement !== document ) {\n\n\t\t\t\tthis.domElement.focus();\n\n\t\t\t}\n\n\t\t\tif ( this.activeLook ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase 0: this.moveForward = true; break;\n\t\t\t\t\tcase 2: this.moveBackward = true; break;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.mouseDragOn = true;\n\n\t\t};\n\n\t\tthis.onPointerUp = function ( event ) {\n\n\t\t\tif ( this.activeLook ) {\n\n\t\t\t\tswitch ( event.button ) {\n\n\t\t\t\t\tcase 0: this.moveForward = false; break;\n\t\t\t\t\tcase 2: this.moveBackward = false; break;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.mouseDragOn = false;\n\n\t\t};\n\n\t\tthis.onPointerMove = function ( event ) {\n\n\t\t\tif ( this.domElement === document ) {\n\n\t\t\t\tthis.pointerX = event.pageX - this.viewHalfX;\n\t\t\t\tthis.pointerY = event.pageY - this.viewHalfY;\n\n\t\t\t} else {\n\n\t\t\t\tthis.pointerX = event.pageX - this.domElement.offsetLeft - this.viewHalfX;\n\t\t\t\tthis.pointerY = event.pageY - this.domElement.offsetTop - this.viewHalfY;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onKeyDown = function ( event ) {\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'KeyW': this.moveForward = true; break;\n\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'KeyA': this.moveLeft = true; break;\n\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'KeyS': this.moveBackward = true; break;\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'KeyD': this.moveRight = true; break;\n\n\t\t\t\tcase 'KeyR': this.moveUp = true; break;\n\t\t\t\tcase 'KeyF': this.moveDown = true; break;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.onKeyUp = function ( event ) {\n\n\t\t\tswitch ( event.code ) {\n\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'KeyW': this.moveForward = false; break;\n\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'KeyA': this.moveLeft = false; break;\n\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 'KeyS': this.moveBackward = false; break;\n\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'KeyD': this.moveRight = false; break;\n\n\t\t\t\tcase 'KeyR': this.moveUp = false; break;\n\t\t\t\tcase 'KeyF': this.moveDown = false; break;\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.lookAt = function ( x, y, z ) {\n\n\t\t\tif ( x.isVector3 ) {\n\n\t\t\t\t_target.copy( x );\n\n\t\t\t} else {\n\n\t\t\t\t_target.set( x, y, z );\n\n\t\t\t}\n\n\t\t\tthis.object.lookAt( _target );\n\n\t\t\tsetOrientation( this );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.update = function () {\n\n\t\t\tconst targetPosition = new Vector3();\n\n\t\t\treturn function update( delta ) {\n\n\t\t\t\tif ( this.enabled === false ) return;\n\n\t\t\t\tif ( this.heightSpeed ) {\n\n\t\t\t\t\tconst y = MathUtils.clamp( this.object.position.y, this.heightMin, this.heightMax );\n\t\t\t\t\tconst heightDelta = y - this.heightMin;\n\n\t\t\t\t\tthis.autoSpeedFactor = delta * ( heightDelta * this.heightCoef );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.autoSpeedFactor = 0.0;\n\n\t\t\t\t}\n\n\t\t\t\tconst actualMoveSpeed = delta * this.movementSpeed;\n\n\t\t\t\tif ( this.moveForward || ( this.autoForward && ! this.moveBackward ) ) this.object.translateZ( - ( actualMoveSpeed + this.autoSpeedFactor ) );\n\t\t\t\tif ( this.moveBackward ) this.object.translateZ( actualMoveSpeed );\n\n\t\t\t\tif ( this.moveLeft ) this.object.translateX( - actualMoveSpeed );\n\t\t\t\tif ( this.moveRight ) this.object.translateX( actualMoveSpeed );\n\n\t\t\t\tif ( this.moveUp ) this.object.translateY( actualMoveSpeed );\n\t\t\t\tif ( this.moveDown ) this.object.translateY( - actualMoveSpeed );\n\n\t\t\t\tlet actualLookSpeed = delta * this.lookSpeed;\n\n\t\t\t\tif ( ! this.activeLook ) {\n\n\t\t\t\t\tactualLookSpeed = 0;\n\n\t\t\t\t}\n\n\t\t\t\tlet verticalLookRatio = 1;\n\n\t\t\t\tif ( this.constrainVertical ) {\n\n\t\t\t\t\tverticalLookRatio = Math.PI / ( this.verticalMax - this.verticalMin );\n\n\t\t\t\t}\n\n\t\t\t\tlon -= this.pointerX * actualLookSpeed;\n\t\t\t\tif ( this.lookVertical ) lat -= this.pointerY * actualLookSpeed * verticalLookRatio;\n\n\t\t\t\tlat = Math.max( - 85, Math.min( 85, lat ) );\n\n\t\t\t\tlet phi = MathUtils.degToRad( 90 - lat );\n\t\t\t\tconst theta = MathUtils.degToRad( lon );\n\n\t\t\t\tif ( this.constrainVertical ) {\n\n\t\t\t\t\tphi = MathUtils.mapLinear( phi, 0, Math.PI, this.verticalMin, this.verticalMax );\n\n\t\t\t\t}\n\n\t\t\t\tconst position = this.object.position;\n\n\t\t\t\ttargetPosition.setFromSphericalCoords( 1, phi, theta ).add( position );\n\n\t\t\t\tthis.object.lookAt( targetPosition );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu );\n\t\t\tthis.domElement.removeEventListener( 'pointerdown', _onPointerDown );\n\t\t\tthis.domElement.removeEventListener( 'pointermove', _onPointerMove );\n\t\t\tthis.domElement.removeEventListener( 'pointerup', _onPointerUp );\n\n\t\t\twindow.removeEventListener( 'keydown', _onKeyDown );\n\t\t\twindow.removeEventListener( 'keyup', _onKeyUp );\n\n\t\t};\n\n\t\tconst _onPointerMove = this.onPointerMove.bind( this );\n\t\tconst _onPointerDown = this.onPointerDown.bind( this );\n\t\tconst _onPointerUp = this.onPointerUp.bind( this );\n\t\tconst _onKeyDown = this.onKeyDown.bind( this );\n\t\tconst _onKeyUp = this.onKeyUp.bind( this );\n\n\t\tthis.domElement.addEventListener( 'contextmenu', contextmenu );\n\t\tthis.domElement.addEventListener( 'pointerdown', _onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointermove', _onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerup', _onPointerUp );\n\n\t\twindow.addEventListener( 'keydown', _onKeyDown );\n\t\twindow.addEventListener( 'keyup', _onKeyUp );\n\n\t\tfunction setOrientation( controls ) {\n\n\t\t\tconst quaternion = controls.object.quaternion;\n\n\t\t\t_lookDirection.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\t\t\t_spherical.setFromVector3( _lookDirection );\n\n\t\t\tlat = 90 - MathUtils.radToDeg( _spherical.phi );\n\t\t\tlon = MathUtils.radToDeg( _spherical.theta );\n\n\t\t}\n\n\t\tthis.handleResize();\n\n\t\tsetOrientation( this );\n\n\t}\n\n}\n\nfunction contextmenu( event ) {\n\n\tevent.preventDefault();\n\n}\n\nexport { FirstPersonControls };\n"],
  "mappings": "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",
  "names": []
}
